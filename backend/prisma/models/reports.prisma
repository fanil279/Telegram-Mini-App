enum ReasonType {

    SPAM
    SCAM
    HARASSMENT
    INAPPROPRIATE_CONTENT
    MESSAGE_IGNORED
    OTHER

    @@map("reason_type")
    @@schema("base")

}

enum Status {

    PENDING
    RESOLVED
    REJECTED

    @@map("status")
    @@schema("base")

}

model Report {

    id BigInt @id @default(autoincrement())

    match Match? @relation(fields: [matchId], references: [id], onDelete: SetNull)
    matchId BigInt? @map("match_id")

    message Message? @relation("MessageReport", fields: [messageId], references: [id], onDelete: SetNull)
    messageId BigInt? @unique @map("message_id")

    reporter User? @relation("ReporterId", fields: [reporterId], references: [id], onDelete: SetNull)
    reporterId BigInt? @map("reporter_id")

    reported User? @relation("ReportedId", fields: [reportedId], references: [id], onDelete: SetNull)
    reportedId BigInt? @map("reported_id")

    reviewedBy User? @relation("ReviewedBy", fields: [reviewedById], references: [id], onDelete: SetNull)
    reviewedById BigInt? @map("reviewed_by")

    reason ReasonType
    explanation String? @db.VarChar(255)
    status Status @default(PENDING)

    createdAt DateTime @default(now()) @map("created_at")

    @@unique([reporterId, reportedId, reason])

    @@index([reporterId, reportedId, createdAt])

    @@map("reports")

    @@schema("base")

}
