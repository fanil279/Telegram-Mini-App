enum ReasonType {

    SPAM
    SCAM
    HARASSMENT
    INAPPROPRIATE_CONTENT
    MESSAGE_IGNORED
    OTHER

}

enum Status {

    PENDING
    RESOLVED
    REJECTED

}

model Report {

    id          BigInt   @id @default(autoincrement())

    match       Match?   @relation(fields: [matchId], references: [id], onDelete: SetNull, onUpdate: Cascade)
    matchId     BigInt?

    message     Message? @relation("MessageReport", fields: [messageId], references: [id], onDelete: SetNull, onUpdate: Cascade)
    messageId   BigInt?  @unique

    reporter    User?    @relation("ReporterId", fields: [reporterId], references: [id], onDelete: SetNull, onUpdate: Cascade)
    reporterId  BigInt?

    reported    User?    @relation("ReportedId", fields: [reportedId], references: [id], onDelete: SetNull, onUpdate: Cascade)
    reportedId  BigInt?

    reviewedBy  User?    @relation("ReviewedBy", fields: [reviewedById], references: [id], onDelete: SetNull, onUpdate: Cascade)
    reviewedById BigInt?

    reason      ReasonType
    explanation String?  @db.VarChar(255)
    status      Status   @default(PENDING)

    createdAt   DateTime @default(now())

    @@unique([reporterId, reportedId, reason])

    @@index([reporterId, reportedId, createdAt])

}
